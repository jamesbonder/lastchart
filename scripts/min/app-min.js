var app=angular.module("lastchart",["dotjem.routing"]);app.service("api",function(t){var r={};return r.getTopArtists=function(r){var a=t.get("http://ws.audioscrobbler.com/2.0/?method=user.gettopartists&user="+r+"&api_key=0f123375fc773afd63a2058e4d80b8e2&format=json");return a},r.getTopTracks=function(r){var a=t.get("http://ws.audioscrobbler.com/2.0/?method=user.gettoptracks&user="+r+"&api_key=0f123375fc773afd63a2058e4d80b8e2&format=json");return a},r.getTopAlbums=function(r){var a=t.get("http://ws.audioscrobbler.com/2.0/?method=user.gettopalbums&user="+r+"&api_key=0f123375fc773afd63a2058e4d80b8e2&format=json");return a},r.getRecentTracks=function(r){var a=t.get("http://ws.audioscrobbler.com/2.0/?method=user.getrecenttracks&user="+r+"&api_key=0f123375fc773afd63a2058e4d80b8e2&format=json");return a},r}),app.config(function(t,r,a){r.otherwise({redirectTo:"/home"}),a.state("home",{route:"/home",views:{main:{template:"templates/main.html"}}})}),app.controller("mainController",function(t,r){var a=this;t.topArtistsArray=[],t.topTracksArray=[],t.topAlbumsArray=[],t.recentTracks=[],t.search="jamboon",this.topArtists=new Morris.Bar({element:"topartists",data:[],xkey:"name",ykeys:["playcount"],labels:["Play count"],barColors:["#D9540A"]}),this.topTracks=new Morris.Bar({element:"toptracks",data:[],xkey:"name",ykeys:["playcount"],labels:["Play count"],barColors:["#D9540A"]}),this.topAlbums=new Morris.Bar({element:"topalbums",data:[],xkey:"name",ykeys:["playcount"],labels:["Play count"],barColors:["#D9540A"]}),t.completeSearch=function(){r.getTopTracks(t.search).success(function(r){t.topTracksArray!=[]&&(t.topTracksArray=[]);for(var e=0;10>e;e++)t.topTracksArray.push({name:r.toptracks.track[e].name,playcount:parseInt(r.toptracks.track[e].playcount)});a.topTracks.setData(t.topTracksArray)}),r.getTopAlbums(t.search).success(function(r){t.topAlbumsArray!=[]&&(t.topAlbumsArray=[]);for(var e=0;10>e;e++)t.topAlbumsArray.push({name:r.topalbums.album[e].name,playcount:parseInt(r.topalbums.album[e].playcount)});a.topAlbums.setData(t.topAlbumsArray)}),r.getTopArtists(t.search).success(function(r){t.topTracksArray!=[]&&(t.topArtistsArray=[]);for(var e=0;10>e;e++)t.topArtistsArray.push({name:r.topartists.artist[e].name,playcount:parseInt(r.topartists.artist[e].playcount)});a.topArtists.setData(t.topArtistsArray)}),r.getRecentTracks(t.search).success(function(r){t.topTracksArray!=[]&&(t.recentTracks=[]);for(var a=0;5>a;a++)t.recentTracks.push({name:r.recenttracks.track[a].name,image:r.recenttracks.track[a].image[0]["#text"]})})},t.completeSearch()});